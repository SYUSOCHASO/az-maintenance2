<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ニュース一覧 | 株式会社AZメンテナンス</title>
    <link rel="stylesheet" href="az.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* ニュース一覧ページ専用のスタイル */
        .news-archive-main {
            padding-top: 150px; /* 120pxから150pxに増やしてヘッダーとの距離を広げる */
            margin: 0 auto;
            max-width: 1400px;
            padding-bottom: 80px;
        }
        
        .news-archive-title {
            text-align: center;
            font-size: 3.5rem;
            margin-bottom: 50px;
            color: var(--primary-color);
            position: relative;
        }
        
        .news-archive-title::after {
            content: '';
            display: block;
            width: 60px;
            height: 3px;
            background: var(--primary-color);
            margin: 15px auto;
        }
        
        .news-archive-container {
            padding: 0 2rem;
        }
        
        #news-archive-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2.5rem;
            margin-top: 4rem;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 4rem;
        }
        
        .pagination-button {
            padding: 1rem 2rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 0.5rem;
            font-size: 1.6rem;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .pagination-button:hover {
            background-color: #002266;
        }
        
        .pagination-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .pagination-info {
            display: flex;
            align-items: center;
            font-size: 1.6rem;
            color: var(--text-color);
        }
        
        .loading {
            text-align: center;
            font-size: 2rem;
            margin: 4rem 0;
        }
        
        /* レスポンシブ対応 */
        @media (max-width: 1024px) {
            #news-archive-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            #news-archive-grid {
                grid-template-columns: 1fr;
            }
            
            .news-item {
                max-width: 500px;
                margin: 0 auto;
            }
        }
    </style>
</head>
<body>

    <header class="header">
        <nav class="nav">
            <div class="logo">
                <a href="index.html">
                    <img src="image/header-logo.png" alt="AZメンテナンス">
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="index.html#home">ホーム</a></li>
                <li><a href="index.html#about">企業理念</a></li>
                <li><a href="index.html#services">事業内容</a></li>
                <li><a href="index.html#company">会社概要</a></li>
                <li><a href="index.html#contact">お問い合わせ</a></li>
            </ul>
            <div class="header-contact">
                <p class="contact-message">まずはお気軽にお問い合わせください</p>
                <a href="tel:052-990-3608" class="contact-phone">052-990-3608</a>
                <p class="contact-hours">受付時間9:00～18:00(土日祝も受付可能)</p>
            </div>
        </nav>
    </header>

    <main class="news-archive-main">
        <h1 class="news-archive-title">ニュース一覧</h1>
        
        <div class="news-archive-container">
            <div id="news-archive-grid">
                <!-- WordPressからのニュース記事がここに表示されます -->
                <div class="loading">記事を読み込み中...</div>
            </div>
            
            <div class="pagination">
                <button id="prev-page" class="pagination-button" disabled>前のページ</button>
                <div class="pagination-info">1 / 1</div>
                <button id="next-page" class="pagination-button" disabled>次のページ</button>
            </div>
        </div>
    </main>
    
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="image/header-logo.png" alt="AZメンテナンス">
            </div>
            <div class="footer-links">
                <ul>
                    <li><a href="index.html#home">ホーム</a></li>
                    <li><a href="index.html#about">企業理念</a></li>
                    <li><a href="index.html#services">事業内容</a></li>
                    <li><a href="index.html#company">会社概要</a></li>
                    <li><a href="index.html#contact">お問い合わせ</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 株式会社AZメンテナンス All Rights Reserved.</p>
        </div>
    </footer>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>
        AOS.init({
            duration: 1000,
            once: true
        });
        
        document.addEventListener('DOMContentLoaded', () => {
            // ニュース一覧ページの変数
            const newsGrid = document.getElementById('news-archive-grid');
            const prevButton = document.getElementById('prev-page');
            const nextButton = document.getElementById('next-page');
            const paginationInfo = document.querySelector('.pagination-info');
            
            let currentPage = 1;
            let totalPages = 1;
            const perPage = 8; // 1ページあたりの記事数（8個までの記事が1ページ目に表示）
            
            // WordPressからニュース記事を取得して表示する関数
            const fetchWordPressNews = async (page = 1) => {
                if (!newsGrid) return;
                
                // ローディング表示
                newsGrid.innerHTML = '<div class="loading">記事を読み込み中...</div>';
                
                try {
                    // WordPressのREST APIエンドポイント
                    const response = await fetch(`https://azmainte.com/wp/wp-json/wp/v2/posts?_embed&per_page=${perPage}&page=${page}`);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    // 総ページ数を取得
                    totalPages = parseInt(response.headers.get('X-WP-TotalPages')) || 1;
                    
                    // ページネーションの更新
                    updatePagination();
                    
                    const posts = await response.json();
                    
                    // グリッドをクリア
                    newsGrid.innerHTML = '';
                    
                    // 取得した記事をHTMLに変換して表示
                    posts.forEach(post => {
                        // 画像URLを取得（アイキャッチ画像がある場合）
                        let imageUrl = 'image/header-logo.png'; // デフォルト画像
                        if (post._embedded && 
                            post._embedded['wp:featuredmedia'] && 
                            post._embedded['wp:featuredmedia'][0] &&
                            post._embedded['wp:featuredmedia'][0].source_url) {
                            imageUrl = post._embedded['wp:featuredmedia'][0].source_url;
                        }
                        
                        // 記事の抜粋を取得（HTMLタグを除去）
                        const excerpt = post.excerpt.rendered
                            .replace(/<[^>]*>/g, '')
                            .substring(0, 100) + '...';
                        
                        // 記事カードのHTMLを作成
                        const newsItem = document.createElement('div');
                        newsItem.className = 'news-item';
                        newsItem.innerHTML = `
                            <img src="${imageUrl}" alt="${post.title.rendered}" class="news-image">
                            <div class="news-content">
                                <h3 class="news-title">${post.title.rendered}</h3>
                                <p class="news-excerpt">${excerpt}</p>
                                <a href="${post.link}" class="news-link" target="_blank">詳細を見る <i class="fas fa-arrow-right"></i></a>
                            </div>
                        `;
                        
                        newsGrid.appendChild(newsItem);
                    });
                    
                    // 記事がない場合
                    if (posts.length === 0) {
                        newsGrid.innerHTML = '<div class="loading">記事がありません</div>';
                    }
                    
                } catch (error) {
                    console.error('WordPressからのデータ取得に失敗しました:', error);
                    
                    // エラー時にはダミーデータを表示（横4×縦2=8個）
                    newsGrid.innerHTML = '';
                    
                    for (let i = 0; i < 8; i++) {
                        const dummyItem = document.createElement('div');
                        dummyItem.className = 'news-item';
                        dummyItem.innerHTML = `
                            <img src="image/header-logo.png" alt="AZメンテナンス" class="news-image">
                            <div class="news-content">
                                <h3 class="news-title">サンプルニュース ${i + 1}</h3>
                                <p class="news-excerpt">これはサンプルのニュース記事です。WordPressが設定されると、ここに実際のニュース記事が表示されます。</p>
                                <a href="#" class="news-link">詳細を見る <i class="fas fa-arrow-right"></i></a>
                            </div>
                        `;
                        
                        newsGrid.appendChild(dummyItem);
                    }
                }
            };
            
            // ページネーションの更新
            const updatePagination = () => {
                paginationInfo.textContent = `${currentPage} / ${totalPages}`;
                
                // 前ページボタンの有効/無効
                if (currentPage <= 1) {
                    prevButton.disabled = true;
                } else {
                    prevButton.disabled = false;
                }
                
                // 次ページボタンの有効/無効
                if (currentPage >= totalPages) {
                    nextButton.disabled = true;
                } else {
                    nextButton.disabled = false;
                }
            };
            
            // 前ページボタンのクリックイベント
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    fetchWordPressNews(currentPage);
                    // ページトップにスクロール
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            });
            
            // 次ページボタンのクリックイベント
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    fetchWordPressNews(currentPage);
                    // ページトップにスクロール
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            });
            
            // 初期表示
            fetchWordPressNews(currentPage);
            
            // ヘッダーの表示/非表示を制御
            let lastScrollTop = 0;
            const header = document.querySelector('.header');
            
            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                if (scrollTop > lastScrollTop) {
                    // 下スクロール時
                    header.style.transform = 'translateY(-100%)';
                } else {
                    // 上スクロール時
                    header.style.transform = 'translateY(0)';
                }
                
                lastScrollTop = scrollTop;
            });
        });
    </script>
</body>
</html>
